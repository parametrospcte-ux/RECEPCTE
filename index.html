<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RecepDoc ‚Äî Portal de Archivos</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- Fondo decorativo -->
<div class="bg-grid"></div>
<div class="bg-glow"></div>
<div class="bg-glow2"></div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     NAVBAR
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<nav id="navbar">
  <div class="nav-logo">
    <div class="nav-logo-ico">üì•</div>
    <span>RecepDoc</span>
  </div>
  <div class="nav-right">
    <!-- Sin sesi√≥n -->
    <div id="nav-guest">
      <span class="nav-hint">Inicia sesi√≥n para continuar</span>
    </div>
    <!-- Con sesi√≥n -->
    <div id="nav-sesion" style="display:none">
      <button class="nav-btn active" id="nb-subir">üì§ Subir archivo</button>
      <button class="nav-btn" id="nb-admin" style="display:none">‚öôÔ∏è Administraci√≥n</button>
      <img id="nav-foto" class="nav-foto" src="" alt="">
      <span id="nav-nombre" class="nav-nombre"></span>
      <button class="btn-logout" id="btn-logout">Salir</button>
    </div>
  </div>
</nav>

<main>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       VISTA: LOGIN
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="vista centro" id="vista-login">
    <div class="card login-card">
      <div class="card-ico">üìä</div>
      <h2>Bienvenido a RecepDoc</h2>
      <p class="card-sub">Inicia sesi√≥n con tu cuenta de Google para subir tu archivo Excel. Tu nombre, correo, fecha y hora quedar√°n registrados autom√°ticamente.</p>
      <button class="btn-google" id="btn-google">
        <svg width="20" height="20" viewBox="0 0 48 48">
          <path fill="#FFC107" d="M43.6 20H24v8h11.3C33.6 33.1 29.3 36 24 36c-6.6 0-12-5.4-12-12s5.4-12 12-12c3 0 5.7 1.1 7.8 2.9l5.7-5.7C33.8 6.5 29.1 4.5 24 4.5 12.7 4.5 3.5 13.7 3.5 25S12.7 45.5 24 45.5c11 0 20.5-8 20.5-20.5 0-1.4-.1-2.7-.4-3.5z"/>
          <path fill="#FF3D00" d="M6.3 14.7l6.6 4.8C14.6 15.1 19 12 24 12c3 0 5.7 1.1 7.8 2.9l5.7-5.7C33.8 6.5 29.1 4.5 24 4.5c-7.7 0-14.3 4.4-17.7 10.2z"/>
          <path fill="#4CAF50" d="M24 45.5c5 0 9.6-1.9 13.1-5l-6.1-5.1C29.1 37 26.6 38 24 38c-5.2 0-9.6-2.9-11.3-7.1l-6.5 5C9.6 41 16.4 45.5 24 45.5z"/>
          <path fill="#1976D2" d="M43.6 20H24v8h11.3c-.8 2.3-2.3 4.2-4.2 5.6l6.1 5.1C40.7 35.4 44 30.6 44 25c0-1.4-.1-2.7-.4-3.5z"/>
        </svg>
        Acceder con Google
      </button>
      <div class="info-box">
        <span class="info-ico">‚ÑπÔ∏è</span>
        <span>Cualquier cuenta de Google v√°lida puede ingresar. Solo el administrador designado ver√° el panel de gesti√≥n.</span>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       VISTA: SUBIR ARCHIVO
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="vista centro" id="vista-subir" style="display:none">
    <div class="card upload-card">
      <h2>Subir archivo Excel</h2>

      <!-- Barra de usuario -->
      <div class="user-bar">
        <img id="up-foto" src="" alt="" class="user-bar-foto">
        <div>
          <div class="user-bar-nombre" id="up-nombre"></div>
          <div class="user-bar-email" id="up-email"></div>
        </div>
        <span class="user-bar-badge">‚úì Verificado</span>
      </div>

      <!-- Campos del formulario -->
      <div class="form-grid">
        <div class="field">
          <label>Localidad <span class="req">*</span></label>
          <select id="localidad">
            <option value="">‚Äî Seleccione ‚Äî</option>
            <option>Guayaquil</option>
            <option>Quito</option>
            <option>Cuenca</option>
            <option>Manta</option>
            <option>Ambato</option>
            <option>Loja</option>
            <option>Esmeraldas</option>
            <option>Portoviejo</option>
            <option>Machala</option>
            <option>Otra</option>
          </select>
          <span class="field-err" id="err-localidad">Seleccione una localidad</span>
        </div>
        <div class="field">
          <label>C√≥digo de rastreo</label>
          <input type="text" id="codigo" placeholder="Ej: EC-2024-0078">
        </div>
      </div>

      <div class="field" style="margin-bottom:20px">
        <label>Descripci√≥n / Notas</label>
        <textarea id="descripcion" placeholder="Instrucciones especiales o descripci√≥n del contenido‚Ä¶"></textarea>
      </div>

      <!-- Dropzone -->
      <div id="dropzone">
        <input type="file" id="file-input" accept=".xlsx,.xls">
        <div class="dz-ico">üìä</div>
        <div class="dz-title">Arrastra tu archivo aqu√≠</div>
        <div class="dz-sub">o haz clic para seleccionar desde tu dispositivo</div>
        <div class="dz-tags">
          <span class="dz-tag">.xlsx</span>
          <span class="dz-tag">.xls</span>
          <span class="dz-tag">M√°x. 50 MB</span>
        </div>
      </div>
      <span class="field-err" id="err-archivo">Adjunta un archivo Excel (.xls o .xlsx)</span>

      <!-- Preview del archivo -->
      <div id="file-preview" style="display:none">
        <span class="fp-ico">üìó</span>
        <div class="fp-data">
          <div id="fp-nombre"></div>
          <div id="fp-peso"></div>
        </div>
        <button id="btn-cambiar">Cambiar</button>
      </div>

      <!-- Barra de progreso -->
      <div id="progress-wrap" style="display:none">
        <div class="progress-label">
          <span>Subiendo a Firebase Storage‚Ä¶</span>
          <span id="progress-txt">0%</span>
        </div>
        <div class="progress-track"><div id="progress-bar"></div></div>
      </div>

      <button class="btn-primary" id="btn-enviar">
        üì§ Enviar archivo
      </button>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       VISTA: √âXITO
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="vista centro" id="vista-exito" style="display:none">
    <div class="exito-card">
      <div class="exito-ico">‚úÖ</div>
      <h2>¬°Archivo recibido!</h2>
      <p>Tu entrega qued√≥ guardada en Firebase Storage y registrada en Firestore.</p>
      <div class="exito-grid">
        <div class="exito-item full"><label>Enviado por</label><span id="ex-nombre"></span></div>
        <div class="exito-item full"><label>Correo</label><span id="ex-email"></span></div>
        <div class="exito-item full"><label>Archivo</label><span id="ex-archivo"></span></div>
        <div class="exito-item full"><label>Localidad</label><span id="ex-localidad"></span></div>
        <div class="exito-item"><label>Fecha</label><span id="ex-fecha"></span></div>
        <div class="exito-item"><label>Hora</label><span id="ex-hora"></span></div>
      </div>
      <button class="btn-otro" id="btn-otro">Enviar otro archivo</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       VISTA: ADMIN
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="vista" id="vista-admin" style="display:none">
    <div class="admin-wrap">

      <div class="admin-top">
        <div>
          <h2>Panel de Administraci√≥n</h2>
          <p class="admin-sub">Registro de entregas ¬∑ Firebase Storage + Firestore</p>
        </div>
        <div class="admin-acc">
          <button class="btn-excel" id="btn-excel">
            ‚¨á Exportar Excel
          </button>
          <button class="btn-logout" id="btn-logout-admin">Cerrar sesi√≥n</button>
        </div>
      </div>

      <!-- Estad√≠sticas -->
      <div class="stats">
        <div class="stat">
          <div class="stat-lbl">Total archivos</div>
          <div class="stat-val" id="st-total">‚Äî</div>
        </div>
        <div class="stat">
          <div class="stat-lbl">Personas √∫nicas</div>
          <div class="stat-val" id="st-unicos">‚Äî</div>
        </div>
        <div class="stat">
          <div class="stat-lbl">Localidades activas</div>
          <div class="stat-val" id="st-localidades">‚Äî</div>
        </div>
        <div class="stat full">
          <div class="stat-lbl">√öltimo env√≠o</div>
          <div class="stat-val sm" id="st-ultimo">‚Äî</div>
        </div>
      </div>

      <!-- Qui√©nes enviaron -->
      <div class="sec-title">üë• Personas que enviaron archivos</div>
      <div class="panel" style="margin-bottom:24px">
        <div id="admin-personas"><p class="cargando">Cargando‚Ä¶</p></div>
      </div>

      <!-- Tabla completa -->
      <div class="sec-title">üìã Todos los archivos recibidos</div>
      <div class="panel">
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>#</th>
                <th>Remitente</th>
                <th>Localidad</th>
                <th>Archivo</th>
                <th>Tama√±o</th>
                <th>Fecha</th>
                <th>Hora</th>
                <th>Acci√≥n</th>
              </tr>
            </thead>
            <tbody id="tabla-body">
              <tr><td colspan="8" class="td-vacio">Cargando datos‚Ä¶</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

</main>

<!-- Toast -->
<div class="toast" id="toast"></div>

<script type="module" src="app.js"></script>
</body>
</html>
